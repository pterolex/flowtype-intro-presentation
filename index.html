<!DOCTYPE html>
<html lang="en">
<head>
    <title>React Fiber</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="node_modules/shower-ribbon/styles/screen-16x10.css">
    <style>
        .slide {
            padding-top: 25px;
        }

        iframe {
            height: 500px;
            width: 825px;
        }

        .comment-text {
            color: #f00;
        }

        .big-list {
            font-size: 32px;
            line-height: 80px;
        }

        video {
            width: 100%;
            margin-top: 100px;
        }
    </style>
    <script>


    </script>
</head>
<body class="shower list">
    <header class="caption">
        <h1>React Fiber</h1>
    </header>
    <section class="slide" id="cover">

        <h2>React Fiber</h2>

        <img src="images/react-logo.png" />
        <style>
            #cover {
                text-align: center;
            }
            #cover img {
                width: 600px;
            }

            #cover h2 {
                margin:120px 0 0;
                color:black;
                text-align:center;
                font-size: 120px;
            }

            .performance img {
                width: 100%;
            }
        </style>
    </section>

    <section class="slide" id="about">
        <h2>About me</h2>
        <div class="about-cover">
            <img src="images/avatar.jpg" class="avatar" />
            <div>
                <h2>Alexey Zaslavsky</h2>
                <div class="wrapper">
                    Front-end developer at
                    <img class="logo" src="images/wl.png" />
                </div>
            </div>
        </div>

        <style>
            #about .about-cover {
                display: flex;
                align-items: center;
                justify-content: space-around;
                height: 400px;
                font-size: 28px;
            }

            #about .avatar {
                border-radius: 50%;
                width: 300px;
            }

            #about .wrapper {
                display: flex;
                justify-content: center;
                align-items: center;
            }

            #about .logo {
                width: 130px;
                display: inline;
                margin-left: 30px;
            }
        </style>
    </section>

    <section class="slide">
        <h2>What is React Fiber?</h2>
        <ul class="big-list">
            <li class="next">React core algorithm reimplementation</li>
            <li class="next">No change in public API at first release</li>
            <li class="next">First release with v16</li>
        </ul>
    </section>

    <section class="slide">
        <h2 class="shout shrink">Why?</h2>
    </section>

    <section class="slide" id="ideal-app">
        <h2>Smooth application</h2>
        <h2 class="next">60 fps</h2>

        <style>
            #ideal-app {
                padding-top: 200px;
            }
            #ideal-app > h2 {
                text-align: center;
                font-size: 90px;
            }
        </style>
    </section>

    <section class="slide" id="expectation">
        <h2>Expectation</h2>

        <img src="images/expect.png" />

        <style>
            #expectation img {
                width: 100%;
                margin-top: 130px;
            }
        </style>
    </section>

    <section class="slide" id="reality">
        <h2>Reality</h2>

        <img src="images/reality.png" />

        <style>
            #reality img {
                width: 100%;
                margin-top: 130px;
            }
        </style>
    </section>

    <section class="slide" id="problem">
        <h2>What work does React perform?</h2>

        <img src="images/React-tree.png" />

        <style>
        #problem img {
            width: 500px;
            margin-left: 25%;
        }
        </style>
    </section>

    <section class="slide" id="stack">
        <h2>Deep down the call stack...</h2>

        <img src="images/js-stack.png" class="cover"/>

        <style>
        #stack h2 {
            text-align: center;
        }
        </style>
    </section>

    <section class="slide">
        <h2 class="shout shrink">Scheduling</h2>
    </section>

    <section class="slide">
        <h2>How should work be prioritized?</h2>
        <ol class="big-list">
            <li>Data subscriptions</li>
            <li>Text input</li>
            <li>Off-screen elements</li>
            <li>Animations</li>
        </ol>
    </section>

    <section class="slide">
        <h2 class="shout shrink">Demo app</h2>
    </section>

    <section class="slide">
        <video controls loop autoplay="autoplay">
            <source src="stack_example.mov">
        </video>
    </section>

    <section class="slide">
        <h2 class="shout shrink"><a href="http://localhost:8050/examples/fiber/index.html" target="_blank">Demo app <br />with Fiber</a></h2>
    </section>

    <section class="slide">
        <video controls loop autoplay="autoplay">
            <source src="fiber_example.mov">
        </video>
    </section>

    <section class="slide performance">
        <h2>Performance</h2>
        <img src="./images/stack_performance.png" />
    </section>

    <section class="slide performance">
        <h2>Fiber Performance</h2>
        <img src="./images/fiber_performance.png" />
    </section>

    <section class="slide">
        <h2 class="shout shrink">How?</h2>
    </section>

    <section class="slide">
        <h2>Browser APIs for scheduling work</h2>
        <ol class="big-list">
            <li class="next">requestAnimationFrame(callback)</li>
            <li class="next">requestIdleCallback(callback)</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Idea: split the work into smaller chunks</h2>
        <ol class="big-list">
            <li class="next">Perform chunk computation</li>
            <li class="next">Stop and wait for the frame to be drawn</li>
            <li class="next">Perform next chunk computation</li>
        </ol>
    </section>

    <section class="slide">
        <h2>JSX</h2>
        <pre>
            <code> render() {</code>
            <code>      return (</code>
            <code>          <mark>&lt;Block color='red'&gt;</mark></code>
            <code>              &lt;p&gt; 1 &lt;/p&gt;</code>
            <code>              &lt;p&gt; 2 &lt;/p&gt;</code>
            <code>          &lt;/Block&gt;</code>
            <code>      )</code>
            <code> }</code>
        </pre>
    </section>

    <section class="slide">
        <h2>JSX => Javascript</h2>
        <pre>
            <code> render() {</code>
            <code>      return (</code>
            <code>          <mark>React.createElement(Block</mark>, { color: 'red' }</code>
            <code>              React.createElement('p', null, 1),</code>
            <code>              React.createElement('p', null, 2)</code>
            <code>          )</code>
            <code>      )</code>
            <code> }</code>
        </pre>
    </section>

    <section class="slide performance">
        <img src="./images/call-stack.png" />
    </section>

    <section class="slide">
        <h2>How can we pause and resume functions?</h2>
        <ol class="big-list">
            <li>Interrupt current call stack</li>
            <li>Save call stack data</li>
            <li>Perfrom high priority work</li>
            <li>Resume the original call stack</li>
        </ol>
    </section>

    <section class="slide" id="solution">
        <h2 class="shout shrink">Solution: <br />reimplement the call stack!</h2>
        <style>
            #solution {
                text-align: center;
            }
        </style>
    </section>

    <section class="slide">
        <h2 >Fiber is:</h2>
        <ol class="big-list">
            <li>Unit of work</li>
            <li>Virtual stack frame</li>
        </ol>
    </section>

    <section class="slide" id="comparison">
        <table>
            <tr>
                <th>Stack frame</th>
                <th>Fiber</th>
            </tr>
            <tr>
                <td>function</td>
                <td>component type</td>
            </tr>
            <tr>
                <td>body (nested function calls)</td>
                <td>children</td>
            </tr>
            <tr>
                <td>return address</td>
                <td>parent component</td>
            </tr>
            <tr>
                <td>arguments</td>
                <td>props</td>
            </tr>
            <tr>
                <td>return value</td>
                <td>DOM element</td>
            </tr>
        </table>
        <style>
            #comparison tr {
                line-height: 80px;
            }
        </style>
    </section>


    <section class="slide" id="fiber-demo">
        <h2>Let's render a tree</h2>
        <pre>
            <code> &lt;div&gt;</code>
            <code>     &lt;p&gt; 1 &lt;/p&gt;</code>
            <code>     &lt;p&gt; 2 &lt;/p&gt;</code>
            <code> &lt;/div&gt;</code>
        </pre>
    </section>

    <section class="slide" id="debugger">
        <h2><a href="http://localhost:3000/" target="_blank">React Fiber Debugger</a></h2>
        <img src="./images/debugger.png" />
        <style>
            #debugger {
                text-align: center;
            }
            #debugger img {
                width: 600px;
            }
        </style>
    </section>

    <section class="slide">
        <h2>Important new features</h2>
        <ol class="big-list">
            <li class="next">Error boundaries</li>
            <li class="next">Return multiple elements from render</li>
            <!-- <li class="next">API for Portals</li> -->
            <li class="next">API for custom renderers</li>
        </ol>
    </section>

    <section class="slide">
        <h2>Return multiple elements from render</h2>
        <pre>
            <code> render() {</code>
            <code>     return (<mark>[</mark></code>
            <code>          &lt;tr&gt; 1 &lt;/tr&gt;</code>
            <code>          &lt;tr&gt; 2 &lt;/tr&gt;</code>
            <code>     <mark>]</mark>);</code>
            <code> }</code>
        </pre>
    </section>

    <section class="slide" id="isFiberReadyYet">
        <h2>isFiberReadyYet.com</h2>
        <img src="./images/isfiberreadyyet.png" />

        <style>
            #isFiberReadyYet img {
                width: 900px;
            }
        </style>
    </section>

    <section class="slide" id="am-i-using">
        <img src="./images/am-i-using.jpg" class="cover"/>
        <style>
            #am-i-using img {
                height: 100%;
            }
        </style>
    </section>

    <section class="slide">
        <h2>Am I using Fiber?</h2>
        <img src="images/react-dom-fiber.jpg" />
    </section>

    <section class="slide">
        <h2>How to test Fiber today?</h2>
        <ol class="big-list">
            <li>Join beta testers group: <a href="https://facebook.com/groups/reactfiberbeta">facebook.com/groups/reactfiberbeta</a></li>
            <li>Navigate to <a href="https://beta.facebook.com">beta.facebook.com</a></li>
        </ol>
    </section>

    <section class="slide">
        <h2>Test locally</h2>
        <ol class="big-list">
            <li>Master branch at React repository</li>
            <li>npm install react@<mark>next</mark> react-dom@<mark>next</mark></li>
            <li class="next">Use <mark>ReactDOMFiber</mark> instead of ReactDOM</li>
        </ol>
    </section>

    <section class="slide" id="references">
        <h2>References</h2>
        <ul>
            <li><a href="https://www.youtube.com/watch?v=aV1271hd9ew">Andrew Clark: What's Next for React — ReactNext 2016</a></li>
            <li><a href="https://github.com/acdlite/react-fiber-architecture">Andrew Clark: React fiber architecture</a></li>
            <li><a href="https://github.com/koba04/react-fiber-resources">React Fiber resources</a></li>
        </ul>
    </section>

    <section class="slide" id="thanks">
        <h2 class="shout shrink">Thanks!</h2>
    </section>


    <div class="progress"></div>
    <script src="node_modules/shower-core/shower.min.js"></script>
</body>
</html>
